# 📍 距離計算アプリケーション

https://nearbytemple.streamlit.app/

地点から最寄りの寺院までの距離を自動計算するStreamlitアプリケーションです。

## 🌟 機能

- CSVファイルのアップロード
- 住所から緯度・経度の自動取得（ジオコーディング）
- 最寄り寺院の検索と距離計算
- 結果のCSVダウンロード
- サマリー統計の表示

## 📋 必要な環境

- Python 3.13+
- uv (パッケージ管理)

## 🚀 インストール

```bash
# リポジトリのクローン
git clone <repository-url>
cd distance

# 依存関係のインストール
uv sync
```

## 💻 使い方

### 1. アプリケーションの起動

```bash
streamlit run app.py
```

ブラウザが自動的に開き、アプリケーションが表示されます。

### 2. CSVファイルの準備

以下のフォーマットでCSVファイルを準備してください：

```csv
地点名,住所
A,熊本県熊本市中央区坪井6丁目21
B,愛知県豊明市沓掛町山新田２丁目４０−８
C,岩手県陸前高田市竹駒町字下壺153
```

**必須カラム:**
- `地点名`: 地点の識別名
- `住所`: 日本の住所（都道府県から番地まで）

### 3. ファイルのアップロード

1. アプリケーションの「CSVファイルをアップロード」セクションでファイルを選択
2. アップロードされたデータのプレビューを確認
3. 「距離計算を開始」ボタンをクリック

### 4. 結果の確認とダウンロード

処理が完了すると：
- サマリー統計（処理件数、平均距離、最短・最長距離）が表示されます
- 詳細データをテーブル形式で確認できます
- 「CSVファイルをダウンロード」ボタンで結果を保存できます

## 📁 ファイル構成

```
distance/
├── app.py              # Streamlitアプリケーション本体
├── temple_list.csv     # 寺院マスターデータ
├── input.csv          # サンプル入力データ
├── pyproject.toml     # プロジェクト設定
├── uv.lock           # 依存関係ロックファイル
└── README.md         # このファイル
```

## ⚠️ 注意事項

- **API制限**: Nominatim APIには1秒に1リクエストの制限があります
- **大量データ**: 大量のデータを処理する場合は時間がかかります
- **住所の精度**: ジオコーディングの精度は住所の記載方法に依存します

## 🔧 トラブルシューティング

### ジオコーディングが失敗する場合

- 住所が正確に記載されているか確認してください
- 都道府県名から記載されているか確認してください
- 特殊文字や全角スペースが含まれていないか確認してください

### temple_list.csvが見つからないエラー

プロジェクトルートディレクトリに`temple_list.csv`ファイルが存在することを確認してください。

## 📊 出力データフォーマット

結果のCSVファイルには以下のカラムが含まれます：

- `地点名`: 入力された地点名
- `住所`: 入力された住所
- `検索住所`: ジオコーディングに使用された住所
- `緯度・経度`: 取得された座標
- `最寄り寺院名`: 最も近い寺院の名前
- `最寄り寺院_住所`: 寺院の住所
- `最寄り寺院_検索住所`: 寺院のジオコーディング用住所
- `最寄り寺院_緯度・経度`: 寺院の座標
- `距離(km)`: 地点から寺院までの距離（キロメートル）

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。
